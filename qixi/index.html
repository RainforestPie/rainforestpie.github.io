<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rainforestpie.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"giscus","storage":true,"lazyload":true,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="é¹Šæ¡¥ç›¸ä¼š Â· ä¸ƒå¤•å°æ¸¸æˆ           :root {       --fg: #f7f7f8;       --muted: #c8c8d0;       --accent: #ff7bb4; &#x2F;* ç²‰ *&#x2F;       --accent2: #7bdfff; &#x2F;* è“ *&#x2F;       --danger: #ff6b6b;       --ok: #7be27b;">
<meta property="og:type" content="website">
<meta property="og:title" content="é˜®ä»Šå¤©">
<meta property="og:url" content="https://rainforestpie.github.io/qixi/index.html">
<meta property="og:site_name" content="é˜®ä»Šå¤©">
<meta property="og:description" content="é¹Šæ¡¥ç›¸ä¼š Â· ä¸ƒå¤•å°æ¸¸æˆ           :root {       --fg: #f7f7f8;       --muted: #c8c8d0;       --accent: #ff7bb4; &#x2F;* ç²‰ *&#x2F;       --accent2: #7bdfff; &#x2F;* è“ *&#x2F;       --danger: #ff6b6b;       --ok: #7be27b;">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-08-29T08:28:55.293Z">
<meta property="article:modified_time" content="2025-08-29T08:28:55.293Z">
<meta property="article:author" content="rainforest pie">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://rainforestpie.github.io/qixi/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title> | é˜®ä»Šå¤©
</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="é˜®ä»Šå¤©" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">é˜®ä»Šå¤©</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">love is circle</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
  
  

          <div class="content page posts-expand">
            

    
    
    
    <div class="post-block" lang="zh-CN">
      <header class="post-header">

<h1 class="post-title" itemprop="name headline">
</h1>

<div class="post-meta">
  

</div>

</header>

      
      
      
      <div class="post-body">
          <!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>é¹Šæ¡¥ç›¸ä¼š Â· ä¸ƒå¤•å°æ¸¸æˆ</title>
  <meta name="description" content="ä¸€ä¸ªæ— éœ€èµ„æºã€å¯ç›´æ¥éƒ¨ç½²åˆ° GitHub Pages/Hexo/Jekyll çš„ä¸ƒå¤•å°æ¸¸æˆã€‚" />
  <style>
    :root {
      --fg: #f7f7f8;
      --muted: #c8c8d0;
      --accent: #ff7bb4; /* ç²‰ */
      --accent2: #7bdfff; /* è“ */
      --danger: #ff6b6b;
      --ok: #7be27b;
      --bg: #0b0f1a; /* å¤œç©º */
      --bg2: #101629; /* é“¶æ²³ */
      --panel: rgba(255,255,255,.06);
    }
    html,body{height:100%;}
    body{
      margin:0; background: radial-gradient(120vw 80vh at 50% -10%, #1b2444 0%, var(--bg) 45%, #02050b 100%);
      color:var(--fg); font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans SC, Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
      overflow:hidden;
    }
    #wrap{position:relative; width:100vw; height:100vh;}
    canvas{position:absolute; inset:0; width:100%; height:100%; display:block;}

    /* HUD */
    .hud{position:absolute; left:0; right:0; top:0; display:flex; gap:.75rem; align-items:center; padding:10px 12px; backdrop-filter: blur(6px);}
    .chip{background:var(--panel); border:1px solid rgba(255,255,255,.07); border-radius:999px; padding:6px 12px; font-size:14px;}
    .bar{flex:1; height:10px; background:linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,.03)); border:1px solid rgba(255,255,255,.08); border-radius:999px; overflow:hidden;}
    .bar > i{display:block; height:100%; width:0%; background:linear-gradient(90deg, var(--accent), var(--accent2)); transition:width .15s ease-out;}
    .btns{position:absolute; right:10px; top:10px; display:flex; gap:8px;}
    .btn{background:var(--panel); border:1px solid rgba(255,255,255,.08); color:var(--fg); padding:6px 10px; border-radius:10px; cursor:pointer; font-size:14px;}
    .btn:hover{background:rgba(255,255,255,.1)}

    /* ä¸­å¿ƒé¢æ¿ */
    .overlay{position:absolute; inset:0; display:grid; place-items:center; pointer-events:none;}
    .panel{pointer-events:auto; width:min(520px, 90vw); background:rgba(16,22,41,.72); border:1px solid rgba(255,255,255,.12); border-radius:16px; padding:20px; box-shadow:0 10px 40px rgba(0,0,0,.35)}
    h1{margin:.2rem 0 0.25rem; font-weight:800; font-size:clamp(28px, 4vw, 42px); letter-spacing:1px;}
    .subtitle{margin:0 0 10px; color:var(--muted)}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .panel .btn{font-size:16px; padding:10px 14px; border-radius:12px}
    .kbd{font:12px/1.6 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.15); padding:2px 6px; border-radius:6px;}
    .muted{color:var(--muted); font-size:14px}
    .score{font-size:32px; font-weight:800;}

    /* ç§»åŠ¨ç«¯æç¤º */
    .touch{position:absolute; left:50%; bottom:18px; transform:translateX(-50%); color:var(--muted); font-size:13px}
  </style>
</head>
<body>
  <div id="wrap">
    <canvas id="bg"></canvas>
    <canvas id="game"></canvas>

    <div class="hud">
      <span class="chip">â±ï¸ <b id="time">60</b>s</span>
      <div class="bar" title="é¹Šæ¡¥è¿›åº¦"><i id="progress" style="width:0%"></i></div>
      <span class="chip">ğŸ’– <b id="score">0</b></span>
      <span class="chip">ğŸ† <b id="best">0</b></span>
      <div class="btns">
        <button class="btn" id="btnPause">â¸ æš‚åœ</button>
        <button class="btn" id="btnShare">ğŸ”— åˆ†äº«</button>
      </div>
    </div>

    <div class="overlay" id="overlay">
      <div class="panel" id="panel-start">
        <h1>é¹Šæ¡¥ç›¸ä¼š</h1>
        <p class="subtitle">ä¸ƒå¤•ç‰¹åˆ«Â·åœ¨æµæ˜Ÿé›¨ä¸­æ¥ä½ <b>å–œé¹Šç¾½</b> ä¸ <b>å¿ƒå¿ƒ</b>ï¼Œæ­èµ·é¹Šæ¡¥è®©ç‰›éƒç»‡å¥³ç›¸ä¼šï¼</p>
        <ul class="muted" style="margin:.5rem 0 1rem; padding-left: 1.1rem;">
          <li>é”®ç›˜ï¼š<span class="kbd">â†</span>/<span class="kbd">â†’</span> æˆ– <span class="kbd">A</span>/<span class="kbd">D</span> ç§»åŠ¨ï¼›<span class="kbd">ç©ºæ ¼</span> å¼€å§‹/æš‚åœ</li>
          <li>æ‰‹æœºï¼šå·¦å³æ»‘åŠ¨æˆ–æ‹–æ‹½åº•éƒ¨ <b>å°èˆ¹</b>ï¼ˆé“¶æ²³æ‘†æ¸¡ï¼‰æ¥æ¥ç‰©ã€‚</li>
          <li>æ¥ä½ <b>ğŸ’– å¿ƒå¿ƒ</b> å’Œ <b>ğŸª¶ å–œé¹Šç¾½</b> å¾—åˆ†å¹¶å……èƒ½ï¼›å°å¿ƒ <b>âš¡ é›·äº‘</b> æ‰£æ—¶ä¸æ¸…ç©ºè¿å‡»ã€‚</li>
        </ul>
        <div class="row">
          <button class="btn" id="btnStart">âœ¨ å¼€å§‹æ¸¸æˆ</button>
          <button class="btn" id="btnHow">ğŸ“œ è§„åˆ™</button>
        </div>
      </div>

      <div class="panel" id="panel-how" style="display:none;">
        <h1>æ€ä¹ˆç©ï¼Ÿ</h1>
        <p class="muted">60 ç§’å†…å°½é‡å¤šåœ°æ¥ä½å¥½ç‰©ä»¥æå‡ <b>é¹Šæ¡¥è¿›åº¦</b>ã€‚è¿›åº¦æ»¡æ ¼å³æå‰èƒœåˆ©ï¼›æ—¶é—´è€—å°½åˆ™ç»“ç®—å¾—åˆ†ã€‚</p>
        <ul class="muted" style="margin:.5rem 0 1rem; padding-left: 1.1rem;">
          <li>è¿å‡»ï¼šè¿ç»­æ¥ä¸­ä¼šå¢åŠ  <b>å€ç‡</b>ï¼ˆÃ—1 â†’ Ã—2 â†’ Ã—3ï¼‰ã€‚ç¢°åˆ°é›·äº‘å°†æ‰“æ–­ã€‚</li>
          <li>å¥½ç‰©ï¼šğŸ’– <b>+2 åˆ†ï¼Œ+2% è¿›åº¦</b>ï¼›ğŸª¶ <b>+1 åˆ†ï¼Œ+1% è¿›åº¦</b></li>
          <li>é›·äº‘ï¼šâš¡ <b>-5 ç§’</b>ï¼Œå¹¶æ¸…ç©ºå½“å‰å€ç‡</li>
        </ul>
        <div class="row">
          <button class="btn" id="btnBack">è¿”å›</button>
        </div>
      </div>

      <div class="panel" id="panel-over" style="display:none; text-align:center;">
        <div class="score" id="final-score">0</div>
        <p class="muted" id="final-result">ç»“æœ</p>
        <div class="row" style="justify-content:center; margin-top:8px;">
          <button class="btn" id="btnRetry">å†æ¥ä¸€æ¬¡</button>
          <button class="btn" id="btnShare2">åˆ†äº«æˆç»©</button>
          <a class="btn" href="/" style="text-decoration:none;">è¿”å›é¦–é¡µ</a>
        </div>
      </div>
    </div>

    <div class="touch">æç¤ºï¼šå¯ç”¨æ‰‹æŒ‡åœ¨åº•éƒ¨å·¦å³æ‹–åŠ¨å°èˆ¹æ¥æ¥ä½æ‰è½ç‰©</div>
  </div>

  <script>
  // ====== å·¥å…· & ç¯å¢ƒ ======
  const DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
  const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
  const rand = (a, b) => a + Math.random() * (b - a);
  const choice = arr => arr[(Math.random() * arr.length) | 0];

  // æœ¬åœ°å­˜æ¡£
  const Store = {
    get best(){ return +(localStorage.getItem('qixi_best')||0); },
    set best(v){ localStorage.setItem('qixi_best', String(v)); }
  };

  // ç”»å¸ƒ
  const bg = document.getElementById('bg');
  const game = document.getElementById('game');
  const ctxB = bg.getContext('2d');
  const ctx = game.getContext('2d');
  let W=0,H=0;
  function resize(){
    W = bg.width = game.width = Math.floor(window.innerWidth * DPR);
    H = bg.height = game.height = Math.floor(window.innerHeight * DPR);
    bg.style.width = game.style.width = '100%';
    bg.style.height = game.style.height = '100%';
    drawBackdrop(true);
  }
  window.addEventListener('resize', resize);

  // ====== èƒŒæ™¯ï¼šæ˜Ÿç©º & é“¶æ²³ ======
  let stars = [];
  function initStars(){
    stars = Array.from({length:180}, ()=>({
      x: Math.random()*W, y: Math.random()*H, r: Math.random()*1.4 + .4, a: Math.random()*1, s: rand(.05, .3)
    }));
  }
  function drawBackdrop(reset){
    if(reset) initStars();
    ctxB.clearRect(0,0,W,H);
    // é“¶æ²³æ·¡å¸¦
    const g = ctxB.createLinearGradient(W*.3,0, W*.7,H);
    g.addColorStop(0, 'rgba(255,255,255,.06)');
    g.addColorStop(.5, 'rgba(255,255,255,.12)');
    g.addColorStop(1, 'rgba(255,255,255,.06)');
    ctxB.fillStyle = g;
    ctxB.fillRect(W*.28, 0, W*.44, H);

    // æ˜Ÿæ˜Ÿ
    for(const s of stars){
      s.a += s.s; if(s.a>Math.PI*2) s.a = 0;
      const twinkle = (Math.sin(s.a)+1)/2; // 0-1
      ctxB.beginPath();
      ctxB.fillStyle = `rgba(255,255,255,${.35 + .65*twinkle})`;
      ctxB.arc(s.x, s.y, s.r * (0.7 + 0.6*twinkle), 0, Math.PI*2);
      ctxB.fill();
    }
  }

  // ====== æ¸¸æˆçŠ¶æ€ ======
  const $score = document.getElementById('score');
  const $best = document.getElementById('best');
  const $time = document.getElementById('time');
  const $prog = document.getElementById('progress');
  const $overlay = document.getElementById('overlay');
  const $panelStart = document.getElementById('panel-start');
  const $panelHow = document.getElementById('panel-how');
  const $panelOver = document.getElementById('panel-over');
  const $finalScore = document.getElementById('final-score');
  const $finalResult = document.getElementById('final-result');
  const $btnStart = document.getElementById('btnStart');
  const $btnHow = document.getElementById('btnHow');
  const $btnBack = document.getElementById('btnBack');
  const $btnRetry = document.getElementById('btnRetry');
  const $btnPause = document.getElementById('btnPause');
  const $btnShare = document.getElementById('btnShare');
  const $btnShare2 = document.getElementById('btnShare2');

  let running = false, paused = false, over = false;
  let timer = 60; // ç§’
  let score = 0, combo = 0, progress = 0; // 0-100
  let lastT = 0;

  // è§’è‰²ï¼šå°èˆ¹ï¼ˆæ‘†æ¸¡ï¼‰
  const boat = { x:0, y:0, w: 100, h: 14, vx:0 };

  // ç‰©ä½“æ± ï¼šå¥½ç‰©ä¸é›·äº‘
  const objects = []; // {x,y,r,type,vy}
  const TYPES = { HEART: 'heart', FEATHER:'feather', STORM:'storm' };

  function resetGame(){
    score = 0; combo = 0; progress = 0; timer = 60;
    running = true; paused = false; over = false;
    lastT = performance.now();
    objects.length = 0;
    boat.w = Math.max(80, Math.min(160, W*0.12));
    boat.h = Math.max(12, Math.min(20, H*0.016));
    boat.x = W/2; boat.y = H - 60*DPR;
    boat.vx = 0;
    $score.textContent = '0';
    $time.textContent = Math.ceil(timer);
    setOverlay(null);
  }

  function setOverlay(which){
    // which: 'start' | 'how' | 'over' | null
    $overlay.style.display = which? 'grid' : 'none';
    $panelStart.style.display = which==='start' ? 'block':'none';
    $panelHow.style.display = which==='how' ? 'block':'none';
    $panelOver.style.display = which==='over' ? 'block':'none';
  }

  function spawn(){
    // æ¦‚ç‡ï¼šå¿ƒ 45%ï¼Œç¾½ 40%ï¼Œé›· 15%
    const t = Math.random();
    const type = t < .45 ? TYPES.HEART : (t < .85 ? TYPES.FEATHER : TYPES.STORM);
    const baseVy = H * 0.00035; // é€Ÿåº¦åŸºå‡†ï¼ˆéšå±å¹•é«˜ï¼‰
    const vy = baseVy * rand(0.9, 1.8) * (1 + score*0.004);
    const r = (type===TYPES.STORM) ? rand(16, 22)*DPR : rand(12, 18)*DPR;
    objects.push({ x: rand(20*DPR, W-20*DPR), y: -30*DPR, r, type, vy });
  }

  // å‘½ä¸­åˆ¤å®šï¼šåœ† vs çŸ©å½¢
  function hitCircleRect(cx, cy, cr, rx, ry, rw, rh){
    const x = clamp(cx, rx, rx+rw);
    const y = clamp(cy, ry, ry+rh);
    const dx = cx - x, dy = cy - y;
    return (dx*dx + dy*dy) <= cr*cr;
  }

  // éŸ³æ•ˆï¼ˆçº¯ WebAudio åˆæˆï¼Œé¿å…å¤–éƒ¨èµ„æºï¼‰
  const audioCtx = (window.AudioContext? new AudioContext() : null);
  function beep(freq=440, dur=0.06, type='sine', gain=0.03){
    if(!audioCtx) return;
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type = type; o.frequency.value = freq;
    g.gain.value = gain;
    o.connect(g).connect(audioCtx.destination);
    o.start(); o.stop(audioCtx.currentTime + dur);
  }

  // æ¸²æŸ“
  function drawBoat(){
    // èˆ¹ä½“
    ctx.fillStyle = 'rgba(255,255,255,.9)';
    const rx = boat.x - boat.w/2, ry = boat.y - boat.h/2;
    roundRect(ctx, rx, ry, boat.w, boat.h, boat.h/2);
    ctx.fill();
    // èˆ¹å¤´å¿ƒå½¢ç¯
    heart(ctx, rx + boat.w*0.85, ry - boat.h*0.8, 8*DPR, '#ff7bb4');
  }

  function drawObjects(dt){
    for(let i=objects.length-1;i>=0;i--){
      const o = objects[i];
      o.y += o.vy * dt;
      if(o.y - 40*DPR > H){ objects.splice(i,1); continue; }

      if(hitCircleRect(o.x, o.y, o.r, boat.x-boat.w/2, boat.y-boat.h/2, boat.w, boat.h)){
        if(o.type===TYPES.HEART){
          combo = Math.min(3, combo+1);
          const add = 2 * combo;
          score += add; progress = Math.min(100, progress + 2);
          beep(880, .06, 'triangle', 0.035);
        } else if(o.type===TYPES.FEATHER){
          combo = Math.min(3, combo+1);
          const add = 1 * combo;
          score += add; progress = Math.min(100, progress + 1);
          beep(740, .05, 'sine', 0.03);
        } else { // é›·äº‘
          combo = 0; timer = Math.max(0, timer - 5);
          beep(120, .12, 'square', 0.05);
        }
        objects.splice(i,1);
        $score.textContent = score;
      }

      // ç”»
      if(o.type===TYPES.HEART){ heart(ctx, o.x, o.y, o.r, '#ff7bb4'); }
      else if(o.type===TYPES.FEATHER){ feather(ctx, o.x, o.y, o.r); }
      else { storm(ctx, o.x, o.y, o.r); }
    }
  }

  function loop(t){
    if(!running){ requestAnimationFrame(loop); return; }
    const now = t || performance.now();
    let dt = (now - lastT) / 16.67; // çº¦ç­‰äº å¸§æ•°æ¯”ä¾‹
    dt = clamp(dt, 0, 2.5);
    lastT = now;

    if(!paused && !over){
      // æ—¶é—´æ¨è¿›
      timer -= (dt/60);
      if(timer <= 0) { timer = 0; gameOver(false); }

      // ç”Ÿæˆç‰©ä½“ï¼ˆéšæ—¶é—´ä¸åˆ†æ•°ç•¥åŠ å¿«ï¼‰
      if(Math.random() < 0.04 * dt * (1 + score*0.002)) spawn();

      // ç§»åŠ¨èˆ¹
      boat.x = clamp(boat.x + boat.vx * dt, boat.w/2+8*DPR, W-boat.w/2-8*DPR);
    }

    // èƒŒæ™¯é—ªçƒ
    drawBackdrop();

    // æ¸…å±
    ctx.clearRect(0,0,W,H);

    // é“¶æ²³åˆ†éš”ä¸¤å²¸çš„å‰ªå½±ï¼ˆç‰›éƒç»‡å¥³ï¼‰
    drawSilhouettes();

    // æ‰è½ç‰©ä¸åˆ¤å®š
    drawObjects(dt);

    // èˆ¹
    drawBoat();

    // HUD æ›´æ–°
    $time.textContent = Math.ceil(timer);
    $prog.style.width = progress + '%';

    // æ»¡æ ¼å³èƒœåˆ©
    if(progress >= 100 && !over){ gameOver(true); }

    requestAnimationFrame(loop);
  }

  function gameOver(won){
    over = true; running = false;
    const best = Store.best = Math.max(Store.best, score);
    $best.textContent = best;
    $finalScore.textContent = `${score} åˆ†`
    $finalResult.textContent = won ? 'ğŸ‰ é¹Šæ¡¥å·²æˆï¼Œç‰›éƒç»‡å¥³ç›¸ä¼šæˆåŠŸï¼' : 'ğŸ’« æ—¶å…‰å·²å°½ï¼Œæ¥å¹´å†è¯•ï¼Ÿ';
    setOverlay('over');
  }

  // ====== å½¢çŠ¶ç»˜åˆ¶ ======
  function roundRect(ctx, x,y,w,h,r){
    const rr = Math.min(r, w/2, h/2);
    ctx.beginPath();
    ctx.moveTo(x+rr, y);
    ctx.arcTo(x+w, y, x+w, y+h, rr);
    ctx.arcTo(x+w, y+h, x, y+h, rr);
    ctx.arcTo(x, y+h, x, y, rr);
    ctx.arcTo(x, y, x+w, y, rr);
    ctx.closePath();
  }

  function heart(ctx, x,y, r, color){
    ctx.save();
    ctx.translate(x,y); ctx.scale(r/10, r/10);
    ctx.beginPath();
    ctx.moveTo(0,4);
    ctx.bezierCurveTo(0,2, -2,0, -4,0);
    ctx.bezierCurveTo(-7,0, -7,4, -7,4);
    ctx.bezierCurveTo(-7,7, -4,9, 0,12);
    ctx.bezierCurveTo(4,9, 7,7, 7,4);
    ctx.bezierCurveTo(7,4, 7,0, 4,0);
    ctx.bezierCurveTo(2,0, 0,2, 0,4);
    ctx.closePath();
    const g = ctx.createLinearGradient(-8,-2,8,14);
    g.addColorStop(0, color||'#ff7bb4');
    g.addColorStop(1, '#ffd1e6');
    ctx.fillStyle = g; ctx.fill();
    ctx.restore();
  }

  function feather(ctx, x,y, r){
    ctx.save();
    ctx.translate(x,y); ctx.rotate((Math.sin(x*0.01+y*0.01)+1)*0.2);
    const w = r*1.8, h=r*4;
    const g = ctx.createLinearGradient(0,-h/2,0,h/2);
    g.addColorStop(0, '#d9f3ff'); g.addColorStop(1, '#7bdfff');
    ctx.fillStyle = g;
    ctx.beginPath();
    ctx.moveTo(0,-h/2);
    ctx.quadraticCurveTo(w/2,-h/3, 0, h/2);
    ctx.quadraticCurveTo(-w/2,-h/3, 0,-h/2);
    ctx.fill();
    // å¶è„‰
    ctx.strokeStyle = 'rgba(0,0,0,.15)'; ctx.lineWidth = DPR;
    ctx.beginPath(); ctx.moveTo(0,-h/2); ctx.lineTo(0,h/2); ctx.stroke();
    ctx.restore();
  }

  function storm(ctx, x,y, r){
    ctx.save(); ctx.translate(x,y);
    // äº‘
    ctx.fillStyle = '#3e4a62';
    for(let i=0;i<4;i++){
      ctx.beginPath(); ctx.arc((i-1.5)*r*0.8, -r*0.2*Math.sin(i), r*0.65 + (i%2)*1.6, 0, Math.PI*2); ctx.fill();
    }
    // é—ªç”µ
    ctx.strokeStyle = '#ffd166'; ctx.lineWidth = r*0.25; ctx.lineCap='square';
    ctx.beginPath(); ctx.moveTo(-r*0.2,0); ctx.lineTo(0,r*0.9); ctx.lineTo(-r*0.1,r*0.9); ctx.stroke();
    ctx.restore();
  }

  function drawSilhouettes(){
    const margin = 20*DPR; const ground = H - 24*DPR;
    // å·¦å²¸ï¼ˆç»‡å¥³ï¼‰
    ctx.fillStyle = 'rgba(0,0,0,.55)';
    ctx.beginPath(); ctx.moveTo(0,ground); ctx.lineTo(W*0.25, ground-40*DPR); ctx.lineTo(W*0.25, ground); ctx.closePath(); ctx.fill();
    // å³å²¸ï¼ˆç‰›éƒï¼‰
    ctx.beginPath(); ctx.moveTo(W,ground); ctx.lineTo(W*0.75, ground-38*DPR); ctx.lineTo(W*0.75, ground); ctx.closePath(); ctx.fill();

    // ä¸¤ç«¯å°äººå½±ï¼ˆæç®€ï¼‰
    // å·¦
    dotPerson(W*0.2, ground-46*DPR);
    // å³
    dotPerson(W*0.8, ground-44*DPR);
  }
  function dotPerson(x,y){
    ctx.save(); ctx.translate(x,y);
    ctx.fillStyle = 'rgba(0,0,0,.6)';
    ctx.beginPath(); ctx.arc(0,-6*DPR, 4*DPR, 0, Math.PI*2); ctx.fill();
    ctx.fillRect(-3*DPR, -6*DPR, 6*DPR, 12*DPR);
    ctx.restore();
  }

  // ====== è¾“å…¥ ======
  const keys = new Set();
  window.addEventListener('keydown', (e)=>{
    if(e.code==='Space'){ togglePauseOrStart(); }
    keys.add(e.code);
    updateVX();
    // è§£é”éŸ³é¢‘
    if(audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
  });
  window.addEventListener('keyup', (e)=>{ keys.delete(e.code); updateVX(); });

  function updateVX(){
    const left = keys.has('ArrowLeft') || keys.has('KeyA');
    const right = keys.has('ArrowRight') || keys.has('KeyD');
    const speed = Math.max(3.8, Math.min(8.5, W*0.0045));
    boat.vx = (left? -speed:0) + (right? speed:0);
  }

  // è§¦æ‘¸/æ‹–æ‹½
  let dragging = false;
  function pointer(e){
    const rect = game.getBoundingClientRect();
    const x = (e.touches? e.touches[0].clientX : e.clientX) - rect.left;
    boat.x = clamp(x * DPR, boat.w/2+8*DPR, W-boat.w/2-8*DPR);
  }
  game.addEventListener('pointerdown', e=>{ dragging=true; pointer(e); });
  game.addEventListener('pointermove', e=>{ if(dragging) pointer(e); });
  window.addEventListener('pointerup', ()=> dragging=false);
  game.addEventListener('touchstart', e=>{ dragging=true; pointer(e); }, {passive:true});
  game.addEventListener('touchmove', e=>{ if(dragging) pointer(e); }, {passive:true});
  window.addEventListener('touchend', ()=> dragging=false);

  // ====== æ§ä»¶ ======
  function togglePauseOrStart(){
    if(!running && !over){ start(); return; }
    if(over) return;
    paused = !paused; document.getElementById('btnPause').textContent = paused? 'â–¶ï¸ ç»§ç»­':'â¸ æš‚åœ';
  }

  function start(){
    resetGame();
    requestAnimationFrame(loop);
  }

  function share(){
    const text = `æˆ‘åœ¨ã€é¹Šæ¡¥ç›¸ä¼šã€æ‹¿åˆ°äº† ${score} åˆ†ï¼æ¥è¯•è¯•ï¼Ÿ`; 
    const url = location.href.split('#')[0];
    if(navigator.share){ navigator.share({title:'é¹Šæ¡¥ç›¸ä¼š Â· ä¸ƒå¤•å°æ¸¸æˆ', text, url}); }
    else{
      const payload = `${text} \n${url}`;
      navigator.clipboard?.writeText(payload);
      alert('å·²å¤åˆ¶åˆ†äº«æ–‡æ¡ˆåˆ°å‰ªè´´æ¿ï¼Œå¿«å»ç²˜è´´ç»™ TA å§ï¼');
    }
  }

  // ====== äº‹ä»¶ç»‘å®š ======
  document.getElementById('best').textContent = Store.best;
  $btnStart.onclick = ()=> start();
  $btnHow.onclick = ()=> setOverlay('how');
  $btnBack.onclick = ()=> setOverlay('start');
  $btnRetry.onclick = ()=> { setOverlay(null); start(); };
  $btnPause.onclick = ()=> togglePauseOrStart();
  $btnShare.onclick = ()=> share();
  $btnShare2.onclick = ()=> share();

  // åˆå§‹
  resize(); setOverlay('start'); drawBackdrop(true);
  requestAnimationFrame(loop);

  </script>
</body>
</html>

      </div>
      
      
      
    </div>
    

    
    
    


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#panel-start"><span class="nav-number">1.</span> <span class="nav-text">é¹Šæ¡¥ç›¸ä¼š</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#panel-how"><span class="nav-number">2.</span> <span class="nav-text">æ€ä¹ˆç©ï¼Ÿ</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">rainforest pie</p>
  <div class="site-description" itemprop="description">è¿™é‡Œå†™ç«™ç‚¹ç®€ä»‹</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/RainforestPie" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;RainforestPie" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">rainforest pie</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
